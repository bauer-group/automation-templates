name: ðŸ“„ README Update

on:
  push:
    branches: [ main ]
    paths: 
      - 'docs/README.template.md'
      - 'scripts/generate_readme.py'
      - '.github/workflows/readme.yml'
  pull_request:
    branches: [ main ]
    paths:
      - 'docs/README.template.md'
      - 'scripts/generate_readme.py'
  workflow_dispatch:

jobs:
  update-readme:
    runs-on: ubuntu-latest
    permissions:
      contents: write
      pull-requests: write
    
    steps:
      - name: Checkout
        uses: actions/checkout@v4
        with:
          token: ${{ secrets.GITHUB_TOKEN }}

      - name: Generate README
        uses: ./.github/actions/readme-generate
        with:
          template-path: 'docs/README.template.md'
          output-path: 'README.md'
          project-name: 'Automation Templates'
          company-name: 'Bauer Group'
          project-description: 'Zentrale GitHub Actions Templates und Workflows fÃ¼r automatisierte Entwicklungsprozesse'
          contact-email: 'support@bauer-group.com'
          documentation-url: 'https://github.com/bauer-group/automation-templates/wiki'
          support-url: 'https://github.com/bauer-group/automation-templates/issues'

      - name: Push changes
        if: github.event_name != 'pull_request'
        run: |
          if ! git diff --quiet; then
            git push
          fi
